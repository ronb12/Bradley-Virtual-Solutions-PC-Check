<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bradley Virtual Solutions ‚Äì PC Check</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: #fff;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    h2 {
      text-align: center;
      color: #333;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    select, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    #status {
      margin-top: 10px;
      font-weight: bold;
      text-align: center;
      color: #333;
    }
    #progressBar {
      height: 10px;
      background: #ddd;
      border-radius: 5px;
      overflow: hidden;
      margin-bottom: 15px;
    }
    #progressFill {
      height: 100%;
      width: 0%;
      background: #4caf50;
      transition: width 0.3s ease;
    }
    .success-message {
      background-color: #d4edda;
      color: #155724;
      padding: 12px;
      border-radius: 6px;
      margin-top: 15px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Bradley Virtual Solutions<br>PC Compatibility Check</h2>

    <label for="latency">Network Latency (ms):</label>
    <select id="latency">
      <option value="">Detecting...</option>
      <option value="120">120 ms or lower</option>
      <option value="Higher">Higher than 120 ms</option>
    </select>

    <label for="downloadSpeed">Download Speed (Mbps):</label>
    <select id="downloadSpeed">
      <option value="">Not Tested</option>
      <option value="10">10 Mbps or higher</option>
      <option value="Lower">Lower than 10 Mbps</option>
    </select>

    <label for="uploadSpeed">Upload Speed (Mbps):</label>
    <select id="uploadSpeed">
      <option value="">Not Tested</option>
      <option value="3">3 Mbps or higher</option>
      <option value="Lower">Lower than 3 Mbps</option>
    </select>

    <button onclick="autoDetectLatency()">üîÑ Auto-Detect Latency</button>
    <button onclick="runDownloadTest()">üöÄ Run Download Test</button>
    <button onclick="runUploadTest()">üì§ Run Upload Test</button>

    <div id="progressBar"><div id="progressFill"></div></div>
    <div id="status">Status updates will appear here.</div>

    <div id="result" class="success-message" style="display: none;"></div>
  </div>

  <script>
    window.onload = () => {
      autoDetectLatency();
    };

    async function autoDetectLatency() {
      const latencyField = document.getElementById("latency");
      const start = performance.now();
      try {
        await fetch("https://1.1.1.1/cdn-cgi/trace", { mode: "no-cors" });
        const end = performance.now();
        const latency = Math.round(end - start);
        latencyField.value = latency <= 120 ? "120" : "Higher";
        document.getElementById("status").textContent = `üõ∞Ô∏è Latency: ${latency} ms`;
      } catch {
        latencyField.value = "";
        document.getElementById("status").textContent = "‚ö†Ô∏è Latency detection failed.";
      }
    }

    async function runDownloadTest() {
      const field = document.getElementById("downloadSpeed");
      const status = document.getElementById("status");
      const progress = document.getElementById("progressFill");

      progress.style.width = "10%";
      status.textContent = "üì• Running download test...";

      try {
        const testUrl = "https://upload.wikimedia.org/wikipedia/commons/3/3c/Shaki_waterfall.jpg";
        const startTime = performance.now();
        await fetch(testUrl, { cache: "no-cache" });
        const endTime = performance.now();

        const seconds = (endTime - startTime) / 1000;
        const fileSize = 1048576;
        const speedMbps = ((fileSize * 8) / seconds) / 1_000_000;

        field.value = speedMbps >= 10 ? "10" : "Lower";
        status.textContent = `‚úÖ Download Speed: ${speedMbps.toFixed(2)} Mbps`;
        progress.style.width = "100%";

        setTimeout(() => (progress.style.width = "0%"), 3000);
        checkSuccess();
      } catch {
        field.value = "";
        status.textContent = "‚ùå Download test failed.";
      }
    }

    async function runUploadTest() {
      const field = document.getElementById("uploadSpeed");
      const status = document.getElementById("status");
      const progress = document.getElementById("progressFill");

      progress.style.width = "10%";
      status.textContent = "üì§ Running upload test...";

      try {
        const blob = new Blob([new Uint8Array(1024 * 1024)], { type: "application/octet-stream" });
        const start = performance.now();
        await fetch("https://httpbin.org/post", { method: "POST", body: blob });
        const end = performance.now();

        const seconds = (end - start) / 1000;
        const speedMbps = ((blob.size * 8) / seconds) / 1_000_000;

        field.value = speedMbps >= 3 ? "3" : "Lower";
        status.textContent = `‚úÖ Upload Speed: ${speedMbps.toFixed(2)} Mbps`;
        progress.style.width = "100%";

        setTimeout(() => (progress.style.width = "0%"), 3000);
        checkSuccess();
      } catch {
        field.value = "";
        status.textContent = "‚ùå Upload test failed.";
      }
    }

    function checkSuccess() {
      const latency = document.getElementById("latency").value;
      const download = document.getElementById("downloadSpeed").value;
      const upload = document.getElementById("uploadSpeed").value;

      const resultDiv = document.getElementById("result");
      if (latency === "120" && download === "10" && upload === "3") {
        resultDiv.style.display = "block";
        resultDiv.innerHTML = "‚úÖ Your system meets the minimum requirements.";
      } else {
        resultDiv.style.display = "none";
      }
    }
  </script>
</body>
</html>
